<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DataTable - Mazer Admin Dashboard</title>

    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@300;400;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="assets/css/bootstrap.css">

    <link rel="stylesheet" href="assets/vendors/simple-datatables/style.css">

    <link rel="stylesheet" href="assets/vendors/perfect-scrollbar/perfect-scrollbar.css">
    <link rel="stylesheet" href="assets/vendors/bootstrap-icons/bootstrap-icons.css">
    <link rel="stylesheet" href="assets/css/app.css">
    <link rel="shortcut icon" href="assets/images/favicon.svg" type="image/x-icon">

    <style>
        .popupOuter{
            z-index: 50;
            height: 100vh;
            width: 100vw;
            background-color: rgba(0,0,0,.5);
            position: fixed;
            display: flex;
            align-items: center;
            justify-content: center;
            display: none;
            overflow: scroll;
        }
        .popup{
            background: white;
            width: 70%;
            padding: 10px 20px;
            border-radius: 10px;
        }
        .editDetails>p{
            display: inline-block;
        }
        .editDetails{
            display: flex;
            justify-content: space-between;
            margin: 5px auto 30px auto;
        }
        .groupEle{
            display: flex;
            align-items: baseline;
        }
    </style>
</head>

<body>

<!-- ################################ This is popup window for campaign details with all Updates Options ############################### -->

    <!-- <div class="popupOuter">
        <div class="popup">
            
           <form action="" method="post" id="popupForm">
            <div class="editDetails">
                <p>Last Updated By : Raj Ingale</p>
                <div class="col-3 d-flex justify-content-end">
                    <button type="submit"
                        class="btn btn-primary me-1 mb-1" id="editBtn">Edit</button>
                    <button type="button"
                        class="btn btn-light-secondary me-1 mb-1" id="cancelBtn">Cancel</button>
                </div>
            </div>
            <div class="row">
                                                
                <div class="col-md-6 col-12">
                    <div class="form-group">
                        <label for="campaign-name-column">Campaign Name</label>
                        <input type="text" id="campaign-name-column" class="form-control toggleInputAccess"
                            placeholder="Campaign Name" name="fname-column" required disabled >
                    </div>
                </div>


            <div class="col-md-6 col-12">
                <div class="form-group">
                    <label for="campaign-id-column">Campaign ID</label>
                    <input type="number" min="0" id="campaign-id-column" class="form-control toggleInputAccess"
                        placeholder="Campaign ID" name="lname-column" required disabled>
                </div>
            </div>

            
            <div class="col-md-3 col-12">
              <div class="form-group">
                  <label for="client-code-select">Client Code</label>
                  <fieldset class="form-group">
                  <select class="form-select toggleInputAccess" id="client-code-select" style="width: 210px;" disabled>
                    <option value="cs">CS</option>
                    <option value="survey">Survey</option>
                    <option value="eblast">eblast</option>
                </select>
              </fieldset>
              </div>
          </div>

            <div class="col-md-3 col-12">
              <div class="form-group">
                  <label for="category-select">Category</label>

                  
                  <!-- CS options 
                  <fieldset class="form-group csOptions">
                  <select class="form-select toggleInputAccess" id="category-select" style="width: 210px;" disabled>
                    <option value="TGIF (email marketing)">TGIF</option>
                    <option value="ACE">ACE</option>
                    <option value="VIBE">VIBE</option>
                    <option value="IP">IP</option>
                    <option value="TAJ (ARC)">TAJ (ARC)</option>
                    <option value="RAY (INSTA)">RAY (INSTA)</option>
                    <option value="MTH">MTH</option>
                    <option value="Magento">Magento</option>
                    <option value="W8 (CS)">W8 (CS)</option>
                </select>
              </fieldset>

              <!-- Survey options 
              <fieldset class="form-group surveyOptions" style="display: none;">
                <select class="form-select toggleInputAccess" id="category-select" style="width: 210px;" disabled>
                  <option value="PKT">PKT</option>
                  <option value="API">API</option>
                  <option value="W8-RB">W8-RB</option>
                  <option value="W8-LE">W8-LE</option>
                  <option value="W8-LA">W8-LA</option>
                  <option value="W8-Techscore">W8-Techscore</option>
                  <option value="ITBP-Techscore">ITBP-Techscore</option>
                  <option value="MTH API">MTH API</option>
                  <option value="ITBP PKT (.NET)">ITBP PKT (.NET)</option>
                  <option value="Email ijp">Email IJP</option>
              </select>
            </fieldset>

             <!-- E Blast options 
             <fieldset class="form-group eblastOptions" style="display: none;">
              <select class="form-select toggleInputAccess" id="category-select" style="width: 210px;" disabled>
                <option value="ACE eblast">ACE eblast</option>
                <option value="W8 eblast">W8 eblast</option>
            </select>
          </fieldset>
              </div>
          </div>
  
            <div class="col-md-3 col-12">
                <div class="form-group">
                    <label for="country-floating">Country</label>
                    <fieldset class="form-group">
                      <select class="form-select toggleInputAccess" id="country-select"  style="width: 210px;" disabled>
                        <option value="EU">EU</option>
                        <option value="NON-EU">NON-EU</option>
                    </select>
                  </fieldset>
                </div>
            </div>

            <div class="col-md-3 col-12">
                <div class="form-group">
                    <label for="campaign-name-column">Created By</label>
                    <input type="text" id="campaign-name-column" class="form-control toggleInputAccess"
                        placeholder="Campaign Name" name="fname-column" required disabled>
                </div>
            </div>

            <div class="form-group mb-3">
                <label for="comment" class="form-label">
                Comment    
                </label>
                <textarea class="form-control toggleInputAccess" placeholder="If Any" id="comment"
                    rows="2" disabled></textarea>
            </div>
        </div>

           </form>
        </div>
    </div> -->

    <!-- ############################################################################################################ -->


    <!-- ******************** This is popup window for campaign only links update ***************** -->

    <div class="popupOuter">
        <div class="popup">
            
           <form action="" method="post" id="popupForm">
            <div class="editDetails">
                <p>Last Updated By : Raj Ingale</p>
            </div>
         <div class="row">
                                                
          <div class="col-md-6 col-12">
            <div class="form-group">
                <label for="campaign-name-column">Campaign Name</label>
                <input type="text" id="campaign-name-column" class="form-control"
                    placeholder="Campaign Name" name="fname-column" readonly>
            </div>
        </div>


    <div class="col-md-6 col-12">
        <div class="form-group">
            <label for="campaign-id-column">Campaign ID</label>
            <input type="number" id="campaign-id-column" class="form-control"
                placeholder="Campaign ID" name="lname-column" readonly>
        </div>
    </div>

    
    <div class="col-md-3 col-12">
      <div class="form-group">
          <label for="client-code-select">Client Code</label>
          <fieldset class="form-group">
    <input type="number" min="0" id="client-code-select" class="form-control"
                placeholder="Client Code" name="lname-column" readonly>
          <!-- <select class="form-select" id="client-code-select" style="width: 210px;" readonly> -->
            <!-- <option value="cs">CS</option> -->
            <!-- <option value="survey">Survey</option> -->
            <!-- <option value="eblast">eblast</option> -->
        <!-- </select> -->
      </fieldset>
      </div>
  </div>

  <div class="col-md-3 col-12">
    <div class="form-group">
        <label for="category-select">Category</label>

        
        <!-- CS options -->
        <fieldset class="form-group csOptions">
  <input type="number" min="0" id="category-select" class="form-control"
              placeholder="category" name="lname-column" readonly>

    </div>
</div>
<div class="col-md-3 col-12">
  <div class="form-group">
      <label for="country-floating">Country</label>
      <fieldset class="form-group">

<input type="number" min="0" id="country-select" class="form-control"
          placeholder="country" name="lname-column" readonly>
    </fieldset>
  </div>
</div>

<div class="col-md-3 col-12">
  <div class="form-group">
      <label for="campaign-name-column">Created By</label>
      <input type="text" id="campaign-name-column" class="form-control"
          placeholder="name" name="fname-column" readonly>
  </div>
</div>


            <div class="form-group mb-3">
                <h6 for="comment" class="form-label">
                Comment    
                </h6>
                <textarea class="form-control" placeholder="If Any" id="comment"
                    rows="2"></textarea>
            </div>

            <div class="form-group mb-3">
                <h6 for="asset-link-data" class="form-label">
                Add Links   
                </h6>
                <textarea placeholder="Paste Excel Table Here" class="form-control" id="asset-link-data"
                    rows="5" required></textarea>
            </div>

            <div class="col-12 d-flex justify-content-end">
                <button type="submit"
                    class="btn btn-primary me-1 mb-1" id="editBtn">Add Links</button>
                <button type="button"
                    class="btn btn-light-secondary me-1 mb-1" id="cancelBtn">Cancel</button>
            </div>

            <!-- To Show Asset name and links in table form, if want remove style-->
            <div id="output"  style="height: 0px; overflow: hidden;"  >
                <table id="excelDataTable"></table>
              </div>
              <!-- ******************************* -->
        </div>

           </form>
        </div>
    </div> 

    <!-- ***************************************************************************************************** -->


    <div id="app">
        <div id="sidebar" class="active">
            <div class="sidebar-wrapper active">
                <div class="sidebar-header">
                    <div class="d-flex justify-content-between">
                        <div class="logo">
                            <a href="index.html"><img src="assets/images/logo/logo.png" alt="Logo" srcset=""></a>
                        </div>
                        <div class="toggler">
                            <a href="#" class="sidebar-hide d-xl-none d-block"><i class="bi bi-x bi-middle"></i></a>
                        </div>
                    </div>
                </div>
                <div class="sidebar-menu">
                    <ul class="menu">
                        <li class="sidebar-title">Menu</li>

                        <li class="sidebar-item  ">
                            <a href="index.html" class='sidebar-link'>
                                <i class="bi bi-grid-fill"></i>
                                <span>Dashboard</span>
                            </a>
                        </li>

                        <li class="sidebar-item  ">
                            <a href="form-layout.html" class='sidebar-link'>
                                <i class="bi bi-file-earmark-medical-fill"></i>
                                <span>Form Layout</span>
                            </a>
                        </li>

                       
                        <li class="sidebar-item  active">
                            <a href="table-datatable.html" class='sidebar-link'>
                                <i class="bi bi-file-earmark-spreadsheet-fill"></i>
                                <span>Datatable</span>
                            </a>
                        </li>

                    </ul>
                </div>
                <button class="sidebar-toggler btn x"><i data-feather="x"></i></button>
            </div>
        </div>
        <div id="main">
            <header class="mb-3">
                <a href="#" class="burger-btn d-block d-xl-none">
                    <i class="bi bi-justify fs-3"></i>
                </a>
            </header>

            <div class="page-heading">
                <div class="page-title">
                    <div class="row">
                        <div class="col-12 col-md-6 order-md-1 order-last">
                            <h3>DataTable</h3>
                        </div>
                    
                    </div>
                </div>
                <section class="section">
                    <div class="card">

                        <div class="card-body">
                            <table class="table table-striped" id="table1">
                                 <thead>
                                    <tr>
                                        <th>CID</th>
                                        <th>Campaign Name</th>
                                        <th>Country</th>
                                        <th>Client Code</th>
                                        <th>Category</th>
                                        <th>Made by</th>
                                        <th>Date</th>
                                        <th>Status</th>
                                    </tr>
                                </thead>
                             <!--   <tbody>
                                    <tr>
                                        <td>333545</td>
                                        <td>333545-eg-example-abc-q2</td>
                                        <td>EU</td>
                                        <td>CS</td>
                                        <td>TGIF</td>
                                        <td>Raj</td>
                                        <td>13-04-2023</td>
                                        <td>
                                            <span class="badge bg-success">Copleted</span>
                                        </td>
                                    </tr>
                                    
                                    <tr>
                                        <td>323232</td>
                                        <td>323232-ab-example-xyz-q2</td>
                                        <td>NON-EU</td>
                                        <td>CS</td>
                                        <td>TGIF</td>
                                        <td>Raj</td>
                                        <td>12-04-2023</td>
                                        <td>
                                            <span class="badge bg-warning">Pending</span>
                                        </td>
                                    </tr>
                                    
                                </tbody> -->
                            </table>
                        </div>
                    </div>

                </section>
            </div>

            <footer>
               
            </footer>
        </div>
    </div>
    <script src="assets/js/main.js"></script>
    <script src="assets/vendors/perfect-scrollbar/perfect-scrollbar.min.js"></script>
    <script src="assets/js/bootstrap.bundle.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>
    <script src="https://cdn.datatables.net/1.11.1/js/jquery.dataTables.min.js"></script>
    <script  src="https://cdn.datatables.net/1.11.1/js/dataTables.bootstrap5.min.js"></script>
        <!-- this is dependency required to convert excel data to json -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Dynatable/0.3.1/jquery.dynatable.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.4/jquery.min.js"
        integrity="sha512-pumBsjNRGGqkPzKHndZMaAG+bir374sORyzM3uulLV14lN5LyykqNk8eEeUlUkB3U0M4FApyaHraT65ihJhDpQ=="
        crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="./assets/js/extensions/sweetalert2.js"></script>
    <script src="./assets/vendors/sweetalert2/sweetalert2.all.min.js"></script>
        <script>
    
             $('#table1').on('mouseover', 'tbody tr', function () {
                $(this).css({"outline": "1px solid grey", "cursor": "pointer"})
            }).on('mouseout', 'tbody tr', function () {
                $(this).css({"outline": "0px solid "})
            })
    
//    ############### Below code is to Fetch and display table data #####################

          fetch('http://localhost:1010/camp-list/camp-data', {
          credentials: 'include',
        })
          .then(response => response.json())
          .then(json => {const data=json;
            table = $('#table1').DataTable({
          data:data,
           columns: [
               { data: 'CID' },
               { data: 'Campaign_Name' },
               { data: 'Country' },
               { data: 'Client_Code' },
               { data: 'Category' },
               { data: 'EDM_Completed_By' },
               { data: 'Date' },
               { data: 'status' }
             ]
           })
        }).catch(err =>{swal.fire({
                                title: "Error",
                                text: "error",
                                icon: "error",
                                confirmButtonText: "Ok"
                            }).then(function (result) {
                                if (true) {
                                  window.location = "http://localhost/New%20folder%20(11)/dist/auth-login.html";
                                }
                            })
                          }


        
        
        
        );

// #########################################################################
$('#cancelBtn').click(function(){
                $('.popupOuter').css({'display':'none'})
                $(".toggleInputAccess").prop("disabled", true);
            })
// ****************** below code is to perform action after clicking on table row ****************************

        $('#table1').on('click', 'tbody tr', function () {
                const row = table.row(this).data();
                console.log(row);

            //fetch data via id code will be here

            $('.popupOuter').css({'display':'flex'})

            })
            
            
// ***********************************************************************************

// ********************* below code to convert table to JSON ****************

$(document).ready(function() {
                var customCellWriter = function(column, record) {
                  var html = column.attributeWriter(record),
                    td = '<td';
                  if (column.hidden || column.textAlign) {
                    td += ' style="';
                    if (column.hidden) {
                      td += 'display: none;';
                    }
                    if (column.textAlign) {
                      td += 'text-align: ' + column.textAlign + ';';
                    }
                    td += '"';
                  }
                  return td + '><div>' + html + '<\/td>';
                };
                var makeElementEditable = function(element) {
                  $('div', element).attr('contenteditable', true);
                  $(element).focusout(function() {
                    $('div', element).attr('contenteditable', false);
                  });
                  $(element).keydown(function(e) {
                    if (e.which == 13) {
                      e.preventDefault();
                      $('div', element).attr('contenteditable', false);
                      $(document).focus();
                    }
                  });
                  $('div', element).on('paste', function(e) {
                    e.preventDefault();
                  });
                };
                // $(document).on('keypress', 'textarea#jsonDataDump', function(e) {
                //   e.preventDefault();
                //   e.stopPropagation();
                // });
                // $(document).on('keypress', 'textarea#asset-link-data', function(e) {
                //   if (e.ctrlKey !== true && e.key != 'v') {
                //     e.preventDefault();
                //     e.stopPropagation();
                //   }
                // });
                $(document).on('paste', 'textarea#asset-link-data', function(e) {
                //   e.preventDefault();
                  var cb;
                  var clipText = '';
                  if (window.clipboardData && window.clipboardData.getData) {
                    cb = window.clipboardData;
                    clipText = cb.getData('Text');
                  } else if (e.clipboardData && e.clipboardData.getData) {
                    cb = e.clipboardData;
                    clipText = cb.getData('text/plain');
                  } else {
                    cb = e.originalEvent.clipboardData;
                    clipText = cb.getData('text/plain');
                  }
                  var clipRows = clipText.split('\n');
                  for (i = 0; i < clipRows.length; i++) {
                    clipRows[i] = clipRows[i].split('\t');
                  }
                  var jsonObj = [];
                  for (i = 0; i < clipRows.length - 1; i++) {
                    var item = {};
                    for (j = 0; j < clipRows[i].length; j++) {
                      if (clipRows[i][j] != '\r') {
                        if (clipRows[i][j].length !== 0) {
                          item[j] = clipRows[i][j];
                        }
                      }
                    }
                    jsonObj.push(item);
                  }
                  $('textarea#jsonDataDump').val('');
                  var tablePlaceHolder = document.getElementById('output');
                  tablePlaceHolder.innerHTML = '';
                  var table = document.createElement('table');
                  table.id = 'excelDataTable';
                  table.className = 'table';
                  var header = table.createTHead();
                  var row = header.insertRow(0);
                  var keys = [];
                  for (var i = 0; i < jsonObj.length; i++) {
                    var obj = jsonObj[i];
                    for (var j in obj) {
                      if ($.inArray(j, keys) == -1) {
                        keys.push(j);
                      }
                    }
                  }
                  keys.forEach(function(value, index) {
                    var headerCell = document.createElement('th');
                    headerCell.innerHTML = '<div>' + value + '<\/div>';
                    $(headerCell).click(function() {
                      makeElementEditable(this);
                    });
                    $(headerCell).keyup(function(e) {
                      var ignoredClass = 'ignored';
                      var ignoredAttr = 'data-attr-ignore';
                      var columnCells = $('td, th', table).filter(':nth-child(' + ($(this).index() + 1) + ')');
                      $(this).removeAttr(ignoredAttr);
                      $(columnCells).each(function() {
                        $(this).removeClass(ignoredClass);
                        $(this).removeAttr(ignoredAttr);
                      });
                      if ($(this).is(':empty') || $(this).text().trim() === '') {
                        $(this).attr(ignoredAttr, '');
                        $(columnCells).each(function() {
                          $(this).addClass(ignoredClass);
                          $(this).attr(ignoredAttr, '');
                        });
                      }
                    });
                    var cell = row.insertCell(index);
                    cell.parentNode.insertBefore(headerCell, cell);
                    cell.parentNode.removeChild(cell);
                  });
                  tablePlaceHolder.appendChild(table);
                  var excelDynaTable = $('table#excelDataTable').dynatable({
                    features: {
                      paginate: false,
                      search: false,
                      recordCount: true,
                      sort: false
                    },
                    dataset: {
                      records: jsonObj
                    },
                    writers: {
                      _cellWriter: customCellWriter
                    }
                  });

                  // below code convert table to json automatically after pasting*******************************
                  var $rows = $('table#excelDataTable').find('tr:not(:hidden)');
                  var headers = [];
                  var data = [];
                  $($rows.shift()).find('th:not(:empty):not([data-attr-ignore])').each(function() {
                    console.log('[' + $(this).text().toLowerCase() + ']');
                    headers.push($(this).text().toLowerCase());
                  });
                  $rows.each(function() {
                    var $td = $(this).find('td:not([data-attr-ignore])');
                    var h = {};
                    headers.forEach(function(header, i) {
                      h[header] = $td.eq(i).text();
                    });
                    data.push(h);
                  });
                  var jsonString = JSON.stringify(data, null, 2);
                  $('textarea#jsonDataDump').val(jsonString);
                  console.log(jsonString);
                  var assetLinkJson=data;
                  assetLinkJson.forEach(element => {
                      delete Object.assign(element, {['title']: element['0'] })['0'];
                      delete Object.assign(element, {['link']: element['1'] })['1'];
                    });
                  // ***************************************************************

                  $(document).on('click', 'table#excelDataTable td', function() {
                    makeElementEditable(this);
                  });
                });
                jQuery.fn.pop = [].pop;
                jQuery.fn.shift = [].shift;

                  // below code convert table to json manually using button click  *******************************

                // $(document).on('click', 'button#exportJsonData', function() {
                //   var $rows = $('table#excelDataTable').find('tr:not(:hidden)');
                //   var headers = [];
                //   var data = [];
                //   $($rows.shift()).find('th:not(:empty):not([data-attr-ignore])').each(function() {
                //     console.log('[' + $(this).text().toLowerCase() + ']');
                //     headers.push($(this).text().toLowerCase());
                //   });
                //   $rows.each(function() {
                //     var $td = $(this).find('td:not([data-attr-ignore])');
                //     var h = {};
                //     headers.forEach(function(header, i) {
                //       h[header] = $td.eq(i).text();
                //     });
                //     data.push(h);
                //   });
                //   var jsonString = JSON.stringify(data, null, 2);
                //   $('textarea#jsonDataDump').val(jsonString);
                //   console.log(jsonString);
                // });
              });
    </script>
    <script>
   

$("#success").click(function () {
    swal.fire({
        title: "Error",
        text: "enter Your",
        icon: "error",
        confirmButtonText: "Ok"
    });

});
$("#error").click(function () {
    swal.fire({
        title: "Error",
        text: "enter Your",
        icon: "error",
        confirmButtonText: "Ok"
    });
});
$("#warning").click(function () {
    swal.fire({
        title: "Warning",
        text: "enter Your",
        icon: "warning",
        confirmButtonText: "Ok"
    });
});

</script>
    </script>

</body>

</html>